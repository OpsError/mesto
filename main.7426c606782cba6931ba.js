(()=>{"use strict";class e{constructor(e,t,s,{openDeleteWindow:i},n,o){this._data=e,this._arrayLikes=e.likes,this._templateSelector=t,this._openImage=n,this._element=this._getTemplate(),this._openDeleteWindow=i,this._userId=s,this._handleLikeCard=o,this._elementPhoto=this._element.querySelector(".element__photo"),this._countLikes=this._element.querySelector(".element__like-number"),this._buttonTrash=this._element.querySelector(".element__trash"),this._iconButtonLike=this._element.querySelector(".element__like-icon")}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".element__like").addEventListener("click",(()=>{this._handleLikeCard()})),this._buttonTrash.addEventListener("click",(()=>{this._openDeleteWindow(this._element._element,this._data._id)})),this._elementPhoto.addEventListener("click",(()=>{this._openImage({link:this._data.link,name:this._data.name})}))}getLikes(e){this._countLikes.textContent=e.length}toggleLike(){this._iconButtonLike.classList.toggle("element__like-icon_active")}checkLike(){return this._arrayLikes.some((e=>e._id===this._userId))}deleteWindow(){this._buttonTrash.addEventListener("click",(()=>{this._openDeleteWindow(this,this._data._id)}))}deleteCard(){this._element.remove(),this._element=null}checkId(e){this._data.owner._id!==e&&this._buttonTrash.classList.add("element__trash_blocked")}generateCard(){return this._elementPhoto.src=this._data.link,this._elementPhoto.alt=this._data.name,this._element.querySelector(".element__description").textContent=this._data.name,this.getLikes(this._arrayLikes),this.checkLike()&&this.toggleLike(),this._setEventListeners(),this._element}}class t{constructor(e){this._popupSelector=e,this._handleEscClose=this._handleEscClose.bind(this)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupSelector.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-icon"))&&this.close()}))}}class s extends t{constructor(e,t){super(e),this._handleSubmitForm=t,this._form=e.querySelector(".popup__form"),this._inputList=e.querySelectorAll(".popup__input")}_getInputValues(){return this._inputValueList={},this._inputList.forEach((e=>{this._inputValueList[e.name]=e.value})),this._inputValueList}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._list=this._getInputValues(),this._handleSubmitForm({name:this._list.title,link:this._list.about})})),super.setEventListeners()}close(){super.close(),this._form.reset()}}class i{constructor(e,t){this._formElement=t,this._config=e,this._inputList=Array.from(t.querySelectorAll(this._config.inputSelector)),this._buttonElement=t.querySelector(this._config.submitButtonSelector)}_showInputError=(e,t)=>{const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._config.inputErrorClass),s.textContent=t,s.classList.add(this._config.errorClass)};_hideInputError=e=>{const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""};_checkInputValidity=e=>{e.validity.valid?this._hideInputError(e):(console.log(e.validationMessage),this._showInputError(e,e.validationMessage))};_hasInvalidInput=()=>this._inputList.some((e=>!e.validity.valid));_toggleButtonState=()=>{this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)};_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}cleanErrorMessage(e){this._formElement.querySelector(`.${e.id}-error`).textContent="",e.classList.remove(this._config.inputErrorClass)}blockButtonSave(){this._buttonElement.classList.add("popup__save_inactive"),this._buttonElement.disabled=!0}enableValidation(){this._setEventListeners()}}class n extends t{constructor(e,t){super(e),this._handleSubmitFormDelete=t,this._formDelete=e.querySelector(".popup__form")}setEventListeners(){this._formDelete.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmitFormDelete()})),super.setEventListeners()}}const o=document.querySelector(".page"),r=o.querySelector(".form-edit"),l=o.querySelector(".form-add"),a=o.querySelector(".popup_image-full"),_=o.querySelector(".delete-popup"),h=o.querySelector(".patch-avatar"),u=o.querySelector(".profile__edit-button"),c=o.querySelector(".profile__add-button"),p=o.querySelector(".profile__edit-avatar"),d=o.querySelector(".profile__name"),m=o.querySelector(".profile__description"),f=(o.querySelector(".profile__photo"),r.querySelector(".popup")),v=r.querySelector(".popup__input_type_name"),S=r.querySelector(".popup__input_type_description"),y=h.querySelector(".popup"),L=h.querySelector(".popup__input_type_url"),g=l.querySelector(".popup"),k=l.querySelector(".popup__input_type_title"),E=l.querySelector(".popup__input_type_link"),b=_.querySelector(".popup"),q=(_.querySelector(".popup__save"),a.querySelector(".popup"),{fieldsetSelector:".popup__form-set",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"}),C=new class extends t{constructor(e){super(e),this._image=this._popupSelector.querySelector(".popup__image"),this._figcaption=this._popupSelector.querySelector(".popup__figcaption")}open(e,t){this._image.src=t,this._image.alt=e,this._figcaption.textContent=e,super.open()}}(a);function I({link:e,name:t}){C.open(t,e)}C.setEventListeners();const w=new i(q,l.querySelector(".popup__form")),D=new i(q,r.querySelector(".popup__form")),x=new i(q,h.querySelector(".popup__form"));w.enableValidation(),D.enableValidation(),x.enableValidation();const $=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}_handleResponse(e){return e.ok?e.json():Promise.reject(new Error("Произошла ошибка"))}getInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then(this._handleResponse)}getCard(){return fetch(`${this._url}/cards`,{headers:this._headers}).then(this._handleResponse)}patchInfo(e){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.link})}).then(this._handleResponse)}postCard(e){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers,body:JSON.stringify({data:e})}).then(this._handleResponse)}putLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({data:e})}).then(this._handleResponse)}deleteLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers,body:JSON.stringify({data:e})}).then(this._handleResponse)}patchAvatar(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-60",headers:{authorization:"11c262d9-4172-458c-924e-d3009da526d4","Content-type":"application/json"}}),B=new class{constructor(e){this._title=e.title,this._about=e.about,this._profileName=document.querySelector(".profile__name"),this._profileDescription=document.querySelector(".profile__description"),this._profilePhoto=document.querySelector(".profile__photo")}getUserInfo(){return{name:this._title.textContent,about:this._about.textContent}}setUserInfo({name:e,about:t}){this._profileName.textContent=e,this._profileDescription.textContent=t}setAvatar(e){this._profilePhoto.src=e}}({title:d,about:m});let V,P;Promise.all([$.getInfo(),$.getCard()]).then((e=>{const t=e[0],s=e[1];V=t._id,P=s,B.setUserInfo({name:t.name,about:t.about}),B.setAvatar(t.avatar),N.renderItems(s)}));const T=new s(g,(({name:e,link:t})=>{$.postCard({name:e,link:t}).then((e=>{A(e),console.log(e),T.close()}))}));function A(t){const s=new e(t,"#element",V,{openDeleteWindow:function(){i.open(),i.setEventListeners()}},I,(function(){!function(e,t){e.checkLike()?(console.log(e.checkLike()),$.deleteLike(t).then((t=>{e.getLikes(t.likes),e.toggleLike()}))):(console.log(e.checkLike()),$.putLike(t).then((t=>{e.getLikes(t.likes),e.toggleLike()})))}(s,t._id)}));s.checkId(V),s.deleteWindow();const i=new n(b,(()=>{$.deleteCard(t._id).then((()=>{s.deleteCard(),i.close()}))})),o=s.generateCard();N.addItem(o)}T.setEventListeners();const N=new class{constructor(e,t){this._renderer=e,this._selector=document.querySelector(t)}addItem(e){this._selector.prepend(e)}renderItems(e){e.reverse().forEach((e=>{this._renderer(e),console.log(e)}))}}(A,".elements"),R=new s(f,(({name:e,link:t})=>{$.patchInfo({name:e,link:t}).then((e=>{console.log(e),B.setUserInfo({name:e.name,about:e.about}),R.close()}))}));R.setEventListeners();const M=new class extends t{constructor(e,t){super(e),this._handleSubmitForm=t,this._form=e.querySelector(".popup__form"),this._inputData=e.querySelector(".popup__input")}_getInputValues(){return this._inputData.value}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._url=this._getInputValues(),console.log(this._url),this._handleSubmitForm(this._url)})),super.setEventListeners()}close(){super.close(),this._form.reset()}}(y,(e=>{$.patchAvatar(e).then((e=>{B.setAvatar(e.avatar),M.close()}))}));c.addEventListener("click",(()=>{T.open(),w.cleanErrorMessage(k),w.cleanErrorMessage(E),k.value="",E.value="",w.blockButtonSave()})),u.addEventListener("click",(()=>{const e=B.getUserInfo();v.value=e.name,S.value=e.about,D.cleanErrorMessage(v),D.cleanErrorMessage(S),R.open()})),p.addEventListener("click",(()=>{M.open(),x.cleanErrorMessage(L),L.value="",M.setEventListeners(),x.blockButtonSave()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWdCaEosT0FBTyxHQUN6QixJQUlWa0UsRUFBVTlGLGlCQUFpQixTQUFTLEtBQ2hDNkosRUFBYTdILE9BQ2JnRixFQUFrQmhDLGtCQUFrQndCLEdBQ3BDUSxFQUFrQmhDLGtCQUFrQnlCLEdBQ3BDRCxFQUFhMUQsTUFBUSxHQUNyQjJELEVBQVkzRCxNQUFRLEdBQ3BCa0UsRUFBa0IvQixpQkFBaUIsSUFJdkNZLEVBQVc3RixpQkFBaUIsU0FBUyxLQUNqQyxNQUFNK0ssRUFBZWpDLEVBQVNNLGNBQzlCakQsRUFBY3JELE1BQVFpSSxFQUFhNUssS0FDbkNpRyxFQUFhdEQsTUFBUWlJLEVBQWE3SCxNQUNsQytELEVBQW1CakMsa0JBQWtCbUIsR0FDckNjLEVBQW1CakMsa0JBQWtCb0IsR0FDckN1RSxFQUFpQjNJLE1BQU0sSUFJM0IrRCxFQUFhL0YsaUJBQWlCLFNBQVMsS0FDbkM0SyxFQUFnQjVJLE9BQ2hCa0YsRUFBeUJsQyxrQkFBa0JzQixHQUMzQ0EsRUFBZ0J4RCxNQUFRLEdBQ3hCOEgsRUFBZ0IzSSxvQkFDaEJpRixFQUF5QmpDLGlCQUFpQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cEF2YXRhci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKGRhdGEsIHRlbXBsYXRlU2VsZWN0b3IsIHVzZXJJZCwge29wZW5EZWxldGVXaW5kb3d9LCBvcGVuSW1hZ2UsIGhhbmRsZUxpa2VDYXJkKSB7XHJcbiAgICAgICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5fYXJyYXlMaWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fb3BlbkltYWdlID0gb3BlbkltYWdlO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX29wZW5EZWxldGVXaW5kb3cgPSBvcGVuRGVsZXRlV2luZG93O1xyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xyXG5cclxuICAgICAgICB0aGlzLl9lbGVtZW50UGhvdG8gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19waG90bycpO1xyXG4gICAgICAgIHRoaXMuX2NvdW50TGlrZXMgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlLW51bWJlcicpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvblRyYXNoID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fdHJhc2gnKTtcclxuICAgICAgICB0aGlzLl9pY29uQnV0dG9uTGlrZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2xpa2UtaWNvbicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8v0LLQvtC30LLRgNCw0YnQsNC10YIg0YHQtdC70LXQutGC0L7RgCDRiNCw0LHQu9C+0L3QsFxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcclxuICAgICAgIC5jb250ZW50XHJcbiAgICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnQnKVxyXG4gICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy/Rg9GB0YLQsNC90L7QstGJ0LjQuiDRgdC+0LHRi9GC0LjQuVxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbkxpa2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlJyk7XHJcblxyXG4gICAgICAgIC8v0LvQsNC50LpcclxuICAgICAgICBidXR0b25MaWtlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL9C+0YLQutGA0YvRgtGMINC+0LrQvdC+INGD0LTQsNC70LXQvdC40Y9cclxuICAgICAgICB0aGlzLl9idXR0b25UcmFzaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fb3BlbkRlbGV0ZVdpbmRvdyh0aGlzLl9lbGVtZW50Ll9lbGVtZW50LCB0aGlzLl9kYXRhLl9pZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8v0L7RgtC60YDRi9GC0Ywg0YTQvtGC0L7Qs9GA0LDRhNC40Y5cclxuICAgICAgICB0aGlzLl9lbGVtZW50UGhvdG8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX29wZW5JbWFnZSh7bGluazogdGhpcy5fZGF0YS5saW5rLCBuYW1lOiB0aGlzLl9kYXRhLm5hbWV9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBnZXRMaWtlcyAoYXJyKSB7XHJcbiAgICAgICAgdGhpcy5fY291bnRMaWtlcy50ZXh0Q29udGVudCA9IGFyci5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlTGlrZSgpIHtcclxuICAgICAgICB0aGlzLl9pY29uQnV0dG9uTGlrZS5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19saWtlLWljb25fYWN0aXZlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY2hlY2tMaWtlICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXlMaWtlcy5zb21lKGl0ZW0gPT4gaXRlbS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlV2luZG93KCkge1xyXG4gICAgICAgIHRoaXMuX2J1dHRvblRyYXNoLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9vcGVuRGVsZXRlV2luZG93KHRoaXMsIHRoaXMuX2RhdGEuX2lkKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgY2hlY2tJZCh1c2VySWQpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGF0YS5vd25lci5faWQgIT09IHVzZXJJZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25UcmFzaC5jbGFzc0xpc3QuYWRkKCdlbGVtZW50X190cmFzaF9ibG9ja2VkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8v0YPRgdGC0LDQvdCw0LLQu9C40LLQsNC10YIg0LrQsNGA0YLQvtGH0LrQtSDQvdCw0LfQstCw0L3QuNC1LCDQutCw0YDRgtC40L3QutGDINC4INC+0L/QuNGB0LDQvdC40LVcclxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50UGhvdG8uc3JjID0gdGhpcy5fZGF0YS5saW5rO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnRQaG90by5hbHQgPSB0aGlzLl9kYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fZGVzY3JpcHRpb24nKS50ZXh0Q29udGVudCA9IHRoaXMuX2RhdGEubmFtZTtcclxuICAgICAgICB0aGlzLmdldExpa2VzKHRoaXMuX2FycmF5TGlrZXMpO1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrTGlrZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlTGlrZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cDtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cCcpIHx8IChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWljb24nKSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXAsIGhhbmRsZVN1Ym1pdEZvcm0pIHtcclxuICAgICAgICBzdXBlcihwb3B1cCk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSA9IGhhbmRsZVN1Ym1pdEZvcm07XHJcblxyXG4gICAgICAgIHRoaXMuX2Zvcm0gPSBwb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBwb3B1cC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy/RgdC+0LHQuNGA0LDQtdGCINC00LDQvdC90YvQtSDRgSDQv9C+0LvQtdC5XHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMgKCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0VmFsdWVMaXN0ID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRWYWx1ZUxpc3RbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dFZhbHVlTGlzdDtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpc3QgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXRGb3JtKHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMuX2xpc3QudGl0bGUsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiB0aGlzLl9saXN0LmFib3V0fSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3IgKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvL9GB0LrRgNGL0YLRjCDQvtGI0LjQsdC60YMg0LLQstC+0LTQsFxyXG4gICAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8v0L/RgNC+0LLQtdGA0LrQsCDRhNC+0YDQvNGLINC90LAg0LLQsNC70LjQtNC90L7RgdGC0YxcclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHsgLy/QtdGB0LvQuCDQtdGB0YLRjCDQvtGI0LjQsdC60LBcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvL9C/0YDQvtCy0LXRgNC60LAg0LrQsNC20LTQvtCz0L4g0L/QvtC70Y8g0L3QsCDQvtGI0LjQsdC60YMg0LIg0L/QvtC70LUg0LLQstC+0LTQsFxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8v0YHQtNC10LvQsNGC0Ywg0LrQvdC+0L/QutGDINC90LXQsNC60YLQuNCy0L3QvtC5KNCw0LrRgtC40LLQvdC+0LkpINC/0YDQuCDQvtGI0LjQsdC60LUo0L/RgNCw0LLQuNC70YzQvdC+0Lwg0LLQstC+0LTQtSlcclxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSA9ICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8v0YPRgdGC0LDQvdC+0LLQuNGC0Ywg0YHQu9GD0YjQsNGC0LXQu9C4INC90LAg0LrQsNC20LTRg9GOINGE0L7RgNC80YNcclxuICAgIF9zZXRFdmVudExpc3RlbmVycyAoKSB7XHJcbiAgICAgICAgLy/Qv9GA0L7QstC10YDQuNGC0Ywg0LrQvdC+0L/QutGDINC/0YDQuCDQvtGC0LrRgNGL0YLQuNC4INGE0L7RgNC80YtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICBcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKT0+IHtcclxuICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgICAgIC8v0L/RgNC+0LLQtdGA0Y/RgtGMINC60L3QvtC/0LrRgyDQv9GA0Lgg0LLQstC+0LTQtSDQutCw0LbQtNC+0LPQviDRgdC40LzQstC+0LvQsFxyXG4gICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICBjbGVhbkVycm9yTWVzc2FnZShpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxuICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy/Qt9Cw0LHQu9C+0LrQuNGA0L7QstCw0YLRjCDQutC90L7Qv9C60YMg0L/RgNC4INC+0YLQutGA0YvRgtC40Lgg0L/QvtC/0LDQv9CwXHJcbiAgICBibG9ja0J1dHRvblNhdmUoKSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9fc2F2ZV9pbmFjdGl2ZScpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgICBcclxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cERlbGV0ZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yIChwb3B1cCwgaGFuZGxlU3VibWl0Rm9ybURlbGV0ZSkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwKTtcclxuICAgICAgICAvLyB0aGlzLl9lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXRGb3JtRGVsZXRlID0gaGFuZGxlU3VibWl0Rm9ybURlbGV0ZTtcclxuICAgICAgICB0aGlzLl9mb3JtRGVsZXRlID0gcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy/RgdC70YPRiNCw0YLQtdC70LhcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1EZWxldGUuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybURlbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZGVsZXRlQ2FyZFRlbXBsYXRpb24oKSB7XHJcbiAgICAvLyAgICAgdGhpcy5fZWxlbWVudC5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIC8vICAgICB0aGlzLl9lbGVtZW50Ll9lbGVtZW50ID0gbnVsbDtcclxuICAgIC8vICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgLy8gfVxyXG59IiwiaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbiAgXHJcbmNvbnN0IHBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGFnZScpO1xyXG4gIFxyXG5leHBvcnQgY29uc3QgZm9ybUVkaXRQcm9maWxlID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcuZm9ybS1lZGl0Jyk7XHJcbmV4cG9ydCBjb25zdCBmb3JtQWRkQ2FyZCA9IHBhZ2UucXVlcnlTZWxlY3RvcignLmZvcm0tYWRkJyk7XHJcbmV4cG9ydCBjb25zdCBpbWFnZUZ1bGwgPSBwYWdlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9pbWFnZS1mdWxsJyk7XHJcbmNvbnN0IHdpbmRvd0RlbGV0ZSA9IHBhZ2UucXVlcnlTZWxlY3RvcignLmRlbGV0ZS1wb3B1cCcpO1xyXG5leHBvcnQgY29uc3QgZm9ybVBhdGNoQXZhdGFyID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcucGF0Y2gtYXZhdGFyJylcclxuICBcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkVkaXQgPSBwYWdlLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYnV0dG9uQWRkID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5leHBvcnQgY29uc3QgYnV0dG9uQXZhdGFyID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1hdmF0YXInKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fbmFtZScpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQaG90byA9IHBhZ2UucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3Bob3RvJyk7XHJcbiAgXHJcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXQgPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwJyk7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXRFZGl0ID0gZm9ybUVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBqb2JJbnB1dEVkaXQgPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uJyk7XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBFZGl0QXZhdGFyID0gZm9ybVBhdGNoQXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cCcpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFySW5wdXRFZGl0ID0gZm9ybVBhdGNoQXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV91cmwnKTtcclxuICBcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkID0gZm9ybUFkZENhcmQucXVlcnlTZWxlY3RvcignLnBvcHVwJyk7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXRBZGQgPSBmb3JtQWRkQ2FyZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfdGl0bGUnKTtcclxuZXhwb3J0IGNvbnN0IHNyY0lucHV0QWRkID0gZm9ybUFkZENhcmQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2xpbmsnKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwb3B1cERlbGV0ZSA9IHdpbmRvd0RlbGV0ZS5xdWVyeVNlbGVjdG9yKCcucG9wdXAnKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkRlbGV0ZSA9IHdpbmRvd0RlbGV0ZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3NhdmUnKTtcclxuICBcclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBpbWFnZUZ1bGwucXVlcnlTZWxlY3RvcignLnBvcHVwJyk7XHJcbiAgXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZpZWxkc2V0U2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0tc2V0JyxcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3NhdmUnLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fc2F2ZV9pbmFjdGl2ZScsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXQtZXJyb3JfYWN0aXZlJ1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZU9iamVjdCA9IG5ldyBQb3B1cFdpdGhJbWFnZShpbWFnZUZ1bGwpO1xyXG5wb3B1cEltYWdlT2JqZWN0LnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL9C+0YLQutGA0YvRgtGMINC60LDRgNGC0LjQvdC60YNcclxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5JbWFnZSAoe2xpbmssIG5hbWV9KSB7XHJcbiAgcG9wdXBJbWFnZU9iamVjdC5vcGVuKG5hbWUsIGxpbmspO1xyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwKTtcclxuXHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuICAgICAgICB0aGlzLl9maWdjYXB0aW9uID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ZpZ2NhcHRpb24nKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fZmlnY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0ICcuL2luZGV4LmNzcyc7XHJcblxyXG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XHJcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnO1xyXG5pbXBvcnQgUG9wdXBEZWxldGUgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cERlbGV0ZS5qcyc7XHJcbmltcG9ydCBQb3B1cEF2YXRhciBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwQXZhdGFyLmpzJztcclxuXHJcbmltcG9ydCB7IHZhbGlkYXRpb25Db25maWcsIGZvcm1BZGRDYXJkLCBmb3JtRWRpdFByb2ZpbGUsIGZvcm1QYXRjaEF2YXRhciwgXHJcbiAgICBwb3B1cEFkZCwgcG9wdXBFZGl0LCBwb3B1cEVkaXRBdmF0YXIsIGJ1dHRvbkF2YXRhciwgYnV0dG9uQWRkLCBidXR0b25FZGl0LCBcclxuICAgIG5hbWVJbnB1dEFkZCwgbmFtZUlucHV0RWRpdCwgc3JjSW5wdXRBZGQsIGpvYklucHV0RWRpdCwgcHJvZmlsZU5hbWUsIFxyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLCBhdmF0YXJJbnB1dEVkaXQsIHBvcHVwRGVsZXRlLCBvcGVuSW1hZ2V9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcclxuXHJcbi8vINCS0LDQu9C40LTQsNGG0LjRj1xyXG5jb25zdCBmb3JtQWRkVmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGZvcm1BZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpKTtcclxuY29uc3QgZm9ybUVkaXRWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybUVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpKTtcclxuY29uc3QgZm9ybUVkaXRBdmF0YXJWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbkNvbmZpZywgZm9ybVBhdGNoQXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpKTtcclxuZm9ybUFkZFZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5mb3JtRWRpdFZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5mb3JtRWRpdEF2YXRhclZhbGlkYXRpb24uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiAnaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC02MCcsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogJzExYzI2MmQ5LTQxNzItNDU4Yy05MjRlLWQzMDA5ZGE1MjZkNCcsXHJcbiAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuY29uc3QgaW5mb1VzZXIgPSBuZXcgVXNlckluZm8oe1xyXG4gICAgdGl0bGU6IHByb2ZpbGVOYW1lLFxyXG4gICAgYWJvdXQ6IHByb2ZpbGVEZXNjcmlwdGlvblxyXG59KTtcclxuXHJcbmxldCB1c2VySWQ7XHJcbmxldCBjYXJkRWxlbWVudDtcclxuLy/Qv9C+0LvRg9GH0LXQvdC40LUg0LjQvdGE0L7RgNC80LDRhtC40Lgg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINC4INC60LDRgNGC0L7Rh9C10Log0YEg0YHQtdGA0LLQtdGA0LBcclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbmZvKCksIGFwaS5nZXRDYXJkKCldKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGNvbnN0IHVzZXJEYXRhID0gcmVzWzBdO1xyXG4gICAgY29uc3QgY2FyZHNEYXRhID0gcmVzWzFdO1xyXG4gICAgXHJcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICBjYXJkRWxlbWVudCA9IGNhcmRzRGF0YTtcclxuXHJcbiAgICBpbmZvVXNlci5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgICBhYm91dDogdXNlckRhdGEuYWJvdXRcclxuICAgIH0pO1xyXG4gICAgaW5mb1VzZXIuc2V0QXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcblxyXG4gICAgY2FyZFJlbmRlci5yZW5kZXJJdGVtcyhjYXJkc0RhdGEpO1xyXG4gIH0pO1xyXG5cclxuLy/QtNC+0LHQsNCy0LvQtdC90LjQtSDQvdC+0LLQvtC5INC60LDRgNGC0L7Rh9C60LhcclxuY29uc3QgcG9wdXBBZGRDYXJkID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBBZGQsICh7bmFtZSwgbGlua30pID0+IHtcclxuICAgIGFwaS5wb3N0Q2FyZCh7bmFtZSwgbGlua30pXHJcbiAgICAgICAgLnRoZW4gKChyZXMpID0+IHtcclxuICAgICAgICAgICAgcmVuZGVyQ2FyZChyZXMpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICBwb3B1cEFkZENhcmQuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxufSk7XHJcbnBvcHVwQWRkQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy/RhNGD0L3QutGG0LjRjyDQv9C+0YHRgtCw0LLQuNGC0Ywv0YPQtNCw0LvQuNGC0Ywg0LvQsNC50LpcclxuZnVuY3Rpb24gcHV0TGlrZSAoY2FyZCwgY2FyZElkKSB7XHJcbiBpZiAoY2FyZC5jaGVja0xpa2UoKSkge1xyXG4gICAgY29uc29sZS5sb2coY2FyZC5jaGVja0xpa2UoKSk7XHJcbiAgICBhcGkuZGVsZXRlTGlrZShjYXJkSWQpXHJcbiAgICAgICAgLnRoZW4gKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5nZXRMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgICBjYXJkLnRvZ2dsZUxpa2UoKTtcclxuICAgICAgICB9KTtcclxuIH0gZWxzZSB7XHJcbiAgICBjb25zb2xlLmxvZyhjYXJkLmNoZWNrTGlrZSgpKTtcclxuICAgIGFwaS5wdXRMaWtlKGNhcmRJZClcclxuICAgICAgICAudGhlbiAoKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLmdldExpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgIGNhcmQudG9nZ2xlTGlrZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gfVxyXG59XHJcblxyXG4vLyDRhNGD0L3QutGG0LjRjyDRgNC10L3QtNC10YDQsCDQutCw0YDRgtC+0YfQtdC6XHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQgKGVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChlbGVtZW50LCAnI2VsZW1lbnQnLCB1c2VySWQsIHtvcGVuRGVsZXRlV2luZG93fSwgb3BlbkltYWdlLCBoYW5kbGVMaWtlQ2FyZCk7XHJcbiAgICBjYXJkLmNoZWNrSWQodXNlcklkKTtcclxuICAgIGNhcmQuZGVsZXRlV2luZG93KCk7XHJcblxyXG4gICAgZnVuY3Rpb24gaGFuZGxlTGlrZUNhcmQgKCkge1xyXG4gICAgICAgIHB1dExpa2UoY2FyZCwgZWxlbWVudC5faWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINGD0LTQsNC70LXQvdC40LUg0LrQsNGA0YLQvtGH0LrQuCDRgSDRgdC10YDQstC10YDQsFxyXG4gICAgY29uc3Qgb3BlbkRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwRGVsZXRlKHBvcHVwRGVsZXRlLCAoKSA9PiB7XHJcbiAgICAgICAgYXBpLmRlbGV0ZUNhcmQoZWxlbWVudC5faWQpXHJcbiAgICAgICAgICAgIC50aGVuICgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcclxuICAgICAgICAgICAgICAgIG9wZW5EZWxldGVQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vINGELdGG0LjRjyDQvtGC0LrRgNGL0YLQuNGPINC/0L7Qv9Cw0L/QsCDQuCDQvdCw0LLQtdGI0LjQstCw0L3QuNC1INGB0LvRg9GI0LDRgtC10LvQtdC5XHJcbiAgICBmdW5jdGlvbiBvcGVuRGVsZXRlV2luZG93KCkge1xyXG4gICAgICAgIG9wZW5EZWxldGVQb3B1cC5vcGVuKCk7XHJcbiAgICAgICAgb3BlbkRlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gICAgY2FyZFJlbmRlci5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG5cclxuLy8g0YDQtdC90LTQtdGAINC60LDRgNGC0L7Rh9C10LpcclxuY29uc3QgY2FyZFJlbmRlciA9IG5ldyBTZWN0aW9uKCByZW5kZXJDYXJkLCAnLmVsZW1lbnRzJyk7XHJcblxyXG4vLyDQuNC30LzQtdC90LjRgtGMINC40LzRjyDQuCDQvtC/0LjRgdCw0L3QuNC1INC/0YDQvtGE0LjQu9GPXHJcbmNvbnN0IHBvcHVwRWRpdFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybShwb3B1cEVkaXQsICh7bmFtZSwgbGlua30pID0+IHtcclxuICAgIGFwaS5wYXRjaEluZm8oe25hbWUsIGxpbmt9KVxyXG4gICAgICAgIC50aGVuICgocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgICAgICAgIGluZm9Vc2VyLnNldFVzZXJJbmZvKHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHJlcy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXQ6IHJlcy5hYm91dFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcG9wdXBFZGl0UHJvZmlsZS5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG59KTtcclxuXHJcbnBvcHVwRWRpdFByb2ZpbGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHBvcHVwQXZhdGFyRWRpdCA9IG5ldyBQb3B1cEF2YXRhcihwb3B1cEVkaXRBdmF0YXIsICh1cmwpID0+IHtcclxuICAgIGFwaS5wYXRjaEF2YXRhcih1cmwpXHJcbiAgICAgICAgLnRoZW4gKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaW5mb1VzZXIuc2V0QXZhdGFyKHJlcy5hdmF0YXIpO1xyXG4gICAgICAgICAgICBwb3B1cEF2YXRhckVkaXQuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxufSk7XHJcblxyXG4vL9GB0LvRg9GI0LDRgtC10LvRjCDQutC90L7Qv9C60Lgg0LTQvtCx0LDQstC40YLRjFxyXG5idXR0b25BZGQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBwb3B1cEFkZENhcmQub3BlbigpO1xyXG4gICAgZm9ybUFkZFZhbGlkYXRpb24uY2xlYW5FcnJvck1lc3NhZ2UobmFtZUlucHV0QWRkKTtcclxuICAgIGZvcm1BZGRWYWxpZGF0aW9uLmNsZWFuRXJyb3JNZXNzYWdlKHNyY0lucHV0QWRkKTtcclxuICAgIG5hbWVJbnB1dEFkZC52YWx1ZSA9ICcnO1xyXG4gICAgc3JjSW5wdXRBZGQudmFsdWUgPSAnJztcclxuICAgIGZvcm1BZGRWYWxpZGF0aW9uLmJsb2NrQnV0dG9uU2F2ZSgpO1xyXG59KTtcclxuXHJcbi8v0YHQu9GD0YjQsNGC0LXQu9GMINC60L3QvtC/0LrQuCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPXHJcbmJ1dHRvbkVkaXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBjb25zdCBpbmZvRnJvbVBhZ2UgPSBpbmZvVXNlci5nZXRVc2VySW5mbygpO1xyXG4gICAgbmFtZUlucHV0RWRpdC52YWx1ZSA9IGluZm9Gcm9tUGFnZS5uYW1lO1xyXG4gICAgam9iSW5wdXRFZGl0LnZhbHVlID0gaW5mb0Zyb21QYWdlLmFib3V0O1xyXG4gICAgZm9ybUVkaXRWYWxpZGF0aW9uLmNsZWFuRXJyb3JNZXNzYWdlKG5hbWVJbnB1dEVkaXQpO1xyXG4gICAgZm9ybUVkaXRWYWxpZGF0aW9uLmNsZWFuRXJyb3JNZXNzYWdlKGpvYklucHV0RWRpdCk7XHJcbiAgICBwb3B1cEVkaXRQcm9maWxlLm9wZW4oKTtcclxufSk7XHJcblxyXG4vLyDRgdC70YPRiNCw0YLQtdC70Ywg0LrQvdC+0L/QutC4INC40LfQvNC10L3QuNGC0Ywg0LDQstCw0YLQsNGA0LrRg1xyXG5idXR0b25BdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBwb3B1cEF2YXRhckVkaXQub3BlbigpO1xyXG4gICAgZm9ybUVkaXRBdmF0YXJWYWxpZGF0aW9uLmNsZWFuRXJyb3JNZXNzYWdlKGF2YXRhcklucHV0RWRpdCk7XHJcbiAgICBhdmF0YXJJbnB1dEVkaXQudmFsdWUgPSAnJztcclxuICAgIHBvcHVwQXZhdGFyRWRpdC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgZm9ybUVkaXRBdmF0YXJWYWxpZGF0aW9uLmJsb2NrQnV0dG9uU2F2ZSgpO1xyXG59KTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5fdXJsID0gY29uZmlnLmJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ9Cf0YDQvtC40LfQvtGI0LvQsCDQvtGI0LjQsdC60LAnKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5mbygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuICh0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q2FyZCgpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuICh0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcGF0Y2hJbmZvKGRhdGEpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBhYm91dDogZGF0YS5saW5rXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4gKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBwb3N0Q2FyZChkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiBkYXRhLmxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbiAodGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7ZGF0YX1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtkYXRhfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbiAodGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1dExpa2UoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7ZGF0YX0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtkYXRhfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbiAodGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUxpa2UoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7ZGF0YX0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtkYXRhfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbiAodGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHBhdGNoQXZhdGFyKGxpbmspIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyOiBsaW5rXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4gKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKGRhdGEpIHtcclxuICAgICAgICB0aGlzLl90aXRsZSA9IGRhdGEudGl0bGU7XHJcbiAgICAgICAgdGhpcy5fYWJvdXQgPSBkYXRhLmFib3V0O1xyXG5cclxuICAgICAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19uYW1lJyk7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyk7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZVBob3RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3Bob3RvJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy/RgdC+0LHQuNGA0LDQtdGCINC00LDQvdC90YvQtSDRgdC+INGB0YLRgNCw0L3QuNGG0YtcclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIGNvbnN0IGZvcm1UaXRsZSA9IHRoaXMuX3RpdGxlLnRleHRDb250ZW50O1xyXG4gICAgICAgIGNvbnN0IGZvcm1EZXNjcmlwdGlvbiA9IHRoaXMuX2Fib3V0LnRleHRDb250ZW50O1xyXG4gICAgICAgIHJldHVybiB7bmFtZTogZm9ybVRpdGxlLCBhYm91dDogZm9ybURlc2NyaXB0aW9ufTtcclxuICAgIH1cclxuXHJcbiAgICAvL9GD0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdGCINC90L7QstC+0LUg0LjQvNGPINC4INC+0L/QuNGB0LDQvdC40LVcclxuICAgIHNldFVzZXJJbmZvKHtuYW1lLCBhYm91dH0pIHtcclxuICAgICAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0QXZhdGFyKGF2YXRhcikge1xyXG4gICAgICAgIHRoaXMuX3Byb2ZpbGVQaG90by5zcmMgPSBhdmF0YXI7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyICwgc2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbSAoZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdG9yLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgICAgICBpdGVtcy5yZXZlcnNlKCkuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cEF2YXRhciBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yIChwb3B1cCwgaGFuZGxlU3VibWl0Rm9ybSkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXRGb3JtID0gaGFuZGxlU3VibWl0Rm9ybTtcclxuXHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0RGF0YSA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXQnKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0RGF0YS52YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3VybCA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuX3VybCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0gKHRoaXMuX3VybCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH1cclxufSJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsInVzZXJJZCIsIm9wZW5EZWxldGVXaW5kb3ciLCJvcGVuSW1hZ2UiLCJoYW5kbGVMaWtlQ2FyZCIsInRoaXMiLCJfZGF0YSIsIl9hcnJheUxpa2VzIiwibGlrZXMiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9vcGVuSW1hZ2UiLCJfZWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9vcGVuRGVsZXRlV2luZG93IiwiX3VzZXJJZCIsIl9oYW5kbGVMaWtlQ2FyZCIsIl9lbGVtZW50UGhvdG8iLCJxdWVyeVNlbGVjdG9yIiwiX2NvdW50TGlrZXMiLCJfYnV0dG9uVHJhc2giLCJfaWNvbkJ1dHRvbkxpa2UiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiX2lkIiwibGluayIsIm5hbWUiLCJnZXRMaWtlcyIsImFyciIsInRleHRDb250ZW50IiwibGVuZ3RoIiwidG9nZ2xlTGlrZSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImNoZWNrTGlrZSIsInNvbWUiLCJpdGVtIiwiZGVsZXRlV2luZG93IiwiZGVsZXRlQ2FyZCIsInJlbW92ZSIsImNoZWNrSWQiLCJvd25lciIsImFkZCIsImdlbmVyYXRlQ2FyZCIsInNyYyIsImFsdCIsIlBvcHVwIiwicG9wdXAiLCJfcG9wdXBTZWxlY3RvciIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJvcGVuIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXRGb3JtIiwic3VwZXIiLCJfaGFuZGxlU3VibWl0Rm9ybSIsIl9mb3JtIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRWYWx1ZUxpc3QiLCJmb3JFYWNoIiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsIl9saXN0IiwidGl0bGUiLCJhYm91dCIsInJlc2V0IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiX2NvbmZpZyIsIkFycmF5IiwiZnJvbSIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJjb25zb2xlIiwibG9nIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiY2xlYW5FcnJvck1lc3NhZ2UiLCJibG9ja0J1dHRvblNhdmUiLCJlbmFibGVWYWxpZGF0aW9uIiwiUG9wdXBEZWxldGUiLCJoYW5kbGVTdWJtaXRGb3JtRGVsZXRlIiwiX2hhbmRsZVN1Ym1pdEZvcm1EZWxldGUiLCJfZm9ybURlbGV0ZSIsInBhZ2UiLCJmb3JtRWRpdFByb2ZpbGUiLCJmb3JtQWRkQ2FyZCIsImltYWdlRnVsbCIsIndpbmRvd0RlbGV0ZSIsImZvcm1QYXRjaEF2YXRhciIsImJ1dHRvbkVkaXQiLCJidXR0b25BZGQiLCJidXR0b25BdmF0YXIiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInBvcHVwRWRpdCIsIm5hbWVJbnB1dEVkaXQiLCJqb2JJbnB1dEVkaXQiLCJwb3B1cEVkaXRBdmF0YXIiLCJhdmF0YXJJbnB1dEVkaXQiLCJwb3B1cEFkZCIsIm5hbWVJbnB1dEFkZCIsInNyY0lucHV0QWRkIiwicG9wdXBEZWxldGUiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZmllbGRzZXRTZWxlY3RvciIsInBvcHVwSW1hZ2VPYmplY3QiLCJfaW1hZ2UiLCJfZmlnY2FwdGlvbiIsImZvcm1BZGRWYWxpZGF0aW9uIiwiZm9ybUVkaXRWYWxpZGF0aW9uIiwiZm9ybUVkaXRBdmF0YXJWYWxpZGF0aW9uIiwiYXBpIiwiX3VybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiRXJyb3IiLCJnZXRJbmZvIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0Q2FyZCIsInBhdGNoSW5mbyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicG9zdENhcmQiLCJwdXRMaWtlIiwiZGVsZXRlTGlrZSIsInBhdGNoQXZhdGFyIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsImluZm9Vc2VyIiwiX3RpdGxlIiwiX2Fib3V0IiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVEZXNjcmlwdGlvbiIsIl9wcm9maWxlUGhvdG8iLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwiY2FyZEVsZW1lbnQiLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzRGF0YSIsImNhcmRSZW5kZXIiLCJyZW5kZXJJdGVtcyIsInBvcHVwQWRkQ2FyZCIsInJlbmRlckNhcmQiLCJlbGVtZW50IiwiY2FyZCIsIm9wZW5EZWxldGVQb3B1cCIsImNhcmRJZCIsImFkZEl0ZW0iLCJyZW5kZXJlciIsInNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX3NlbGVjdG9yIiwicHJlcGVuZCIsIml0ZW1zIiwicmV2ZXJzZSIsInBvcHVwRWRpdFByb2ZpbGUiLCJwb3B1cEF2YXRhckVkaXQiLCJfaW5wdXREYXRhIiwidXJsIiwiaW5mb0Zyb21QYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==
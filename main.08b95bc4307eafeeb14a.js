(()=>{"use strict";class e{constructor(e,t,s,{openDeleteWindow:i},n,o){this._data=e,this._arrayLikes=e.likes,this._templateSelector=t,this._openImage=n,this._element=this._getTemplate(),this._openDeleteWindow=i,this._userId=s,this._handleLikeCard=o,this._elementPhoto=this._element.querySelector(".element__photo"),this._countLikes=this._element.querySelector(".element__like-number"),this._buttonTrash=this._element.querySelector(".element__trash"),this._iconButtonLike=this._element.querySelector(".element__like-icon")}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".element__like").addEventListener("click",(()=>{this._handleLikeCard()})),this._buttonTrash.addEventListener("click",(()=>{this._openDeleteWindow(this._element._element,this._data._id)})),this._elementPhoto.addEventListener("click",(()=>{this._openImage({link:this._data.link,name:this._data.name})}))}getLikes(e){this._countLikes.textContent=e.length}toggleLike(){this._iconButtonLike.classList.toggle("element__like-icon_active")}checkLike(){return this._arrayLikes.some((e=>e._id===this._userId))}deleteWindow(){this._buttonTrash.addEventListener("click",(()=>{this._openDeleteWindow(this,this._data._id)}))}deleteCard(){this._element.remove(),this._element=null}checkId(e){this._data.owner._id!==e&&this._buttonTrash.classList.add("element__trash_blocked")}generateCard(){return this._elementPhoto.src=this._data.link,this._elementPhoto.alt=this._data.name,this._element.querySelector(".element__description").textContent=this._data.name,this.getLikes(this._arrayLikes),this.checkLike()&&this.toggleLike(),this._setEventListeners(),this._element}}class t{constructor(e){this._popupSelector=e,this._handleEscClose=this._handleEscClose.bind(this)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupSelector.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-icon"))&&this.close()}))}}class s extends t{constructor(e,t){super(e),this._handleSubmitForm=t,this._form=e.querySelector(".popup__form"),this._inputList=e.querySelectorAll(".popup__input")}_getInputValues(){return this._inputValueList={},this._inputList.forEach((e=>{this._inputValueList[e.name]=e.value})),this._inputValueList}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._list=this._getInputValues(),this._handleSubmitForm({name:this._list.title,link:this._list.about})})),super.setEventListeners()}close(){super.close(),this._form.reset()}}class i{constructor(e,t){this._formElement=t,this._config=e,this._inputList=Array.from(t.querySelectorAll(this._config.inputSelector)),this._buttonElement=t.querySelector(this._config.submitButtonSelector)}_showInputError=(e,t)=>{const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._config.inputErrorClass),s.textContent=t,s.classList.add(this._config.errorClass)};_hideInputError=e=>{const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""};_checkInputValidity=e=>{e.validity.valid?this._hideInputError(e):(console.log(e.validationMessage),this._showInputError(e,e.validationMessage))};_hasInvalidInput=()=>this._inputList.some((e=>!e.validity.valid));_toggleButtonState=()=>{this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)};_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}blockButtonSave(e){this._buttonElement.classList.add("popup__save_inactive"),this._buttonElement.disabled=!0}enableValidation(){this._setEventListeners()}}class n extends t{constructor(e,t){super(e),this._handleSubmitFormDelete=t,this._formDelete=e.querySelector(".popup__form")}setEventListeners(){this._formDelete.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmitFormDelete()})),super.setEventListeners()}}const o=document.querySelector(".page"),r=o.querySelector(".form-edit"),l=o.querySelector(".form-add"),a=document.querySelector(".popup_image-full"),_=document.querySelector(".delete-popup"),h=o.querySelector(".profile__edit-button"),c=o.querySelector(".profile__add-button"),u=o.querySelector(".profile__name"),p=o.querySelector(".profile__description"),d=(o.querySelector(".profile__photo"),r.querySelector(".popup")),m=r.querySelector(".popup__input_type_name"),f=r.querySelector(".popup__input_type_description"),L=l.querySelector(".popup"),k=l.querySelector(".popup__input_type_title"),S=l.querySelector(".popup__input_type_link"),y=_.querySelector(".popup"),g=(_.querySelector(".popup__save"),a.querySelector(".popup"),{fieldsetSelector:".popup__form-set",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"}),v=new class extends t{constructor(e){super(e),this._image=this._popupSelector.querySelector(".popup__image"),this._figcaption=this._popupSelector.querySelector(".popup__figcaption")}open(e,t){this._image.src=t,this._image.alt=e,this._figcaption.textContent=e,super.open()}}(a);function E({link:e,name:t}){v.open(t,e)}v.setEventListeners();const b=new i(g,l.querySelector(".popup__form")),q=new i(g,r.querySelector(".popup__form"));b.enableValidation(),q.enableValidation();const C=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}_handleResponse(e){return e.ok?e.json():Promise.reject(new Error("Произошла ошибка"))}getInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then(this._handleResponse)}getCard(){return fetch(`${this._url}/cards`,{headers:this._headers}).then(this._handleResponse)}patchInfo(e){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.link})}).then(this._handleResponse)}postCard(e){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers,body:JSON.stringify({data:e})}).then(this._handleResponse)}putLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({data:e})}).then(this._handleResponse)}deleteLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers,body:JSON.stringify({data:e})}).then(this._handleResponse)}}({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-60",headers:{authorization:"11c262d9-4172-458c-924e-d3009da526d4","Content-type":"application/json"}}),I=new class{constructor(e){this._title=e.title,this._about=e.about,this._profileName=document.querySelector(".profile__name"),this._profileDescription=document.querySelector(".profile__description"),this._profilePhoto=document.querySelector(".profile__photo")}getUserInfo(){return{name:this._title.textContent,about:this._about.textContent}}setUserInfo({name:e,about:t}){this._profileName.textContent=e,this._profileDescription.textContent=t}setAvatar(e){this._profilePhoto.src=e}}({title:u,about:p});let w,D;Promise.all([C.getInfo(),C.getCard()]).then((e=>{const t=e[0],s=e[1];w=t._id,D=s,I.setUserInfo({name:t.name,about:t.about}),I.setAvatar(t.avatar),$.renderItems(s)}));const x=new s(L,(({name:e,link:t})=>{C.postCard({name:e,link:t}).then((e=>{B(e),console.log(e),x.close()}))}));function B(t){const s=new e(t,"#element",w,{openDeleteWindow:function(){i.open(),i.setEventListeners()}},E,(function(){!function(e,t){e.checkLike()?(console.log(e.checkLike()),C.deleteLike(t).then((t=>{e.getLikes(t.likes),e.toggleLike()}))):(console.log(e.checkLike()),C.putLike(t).then((t=>{e.getLikes(t.likes),e.toggleLike()})))}(s,t._id)}));s.checkId(w),s.deleteWindow();const i=new n(y,(()=>{C.deleteCard(t._id).then((()=>{s.deleteCard(),i.close()}))})),o=s.generateCard();$.addItem(o)}x.setEventListeners();const $=new class{constructor(e,t){this._renderer=e,this._selector=document.querySelector(t)}addItem(e){this._selector.prepend(e)}renderItems(e){e.reverse().forEach((e=>{this._renderer(e),console.log(e)}))}}(B,".elements"),P=new s(d,(({name:e,link:t})=>{C.patchInfo({name:e,link:t}).then((e=>{console.log(e),I.setUserInfo({name:e.name,about:e.about}),P.close()}))}));P.setEventListeners(),c.addEventListener("click",(()=>{x.open(),k.value="",S.value="",b.blockButtonSave(L)})),h.addEventListener("click",(()=>{const e=I.getUserInfo();m.value=e.name,f.value=e.about,P.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Ym1FLEVBQWFyRCxNQUFRLEdBQ3JCc0QsRUFBWXRELE1BQVEsR0FDcEI2RCxFQUFrQjNCLGdCQUFnQmtCLEVBQVMsSUFJL0NQLEVBQVczRixpQkFBaUIsU0FBUyxLQUNqQyxNQUFNcUssRUFBZS9CLEVBQVNNLGNBQzlCNUMsRUFBY2xELE1BQVF1SCxFQUFhbEssS0FDbkM4RixFQUFhbkQsTUFBUXVILEVBQWFuSCxNQUNsQ2tILEVBQWlCcEksTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCB0ZW1wbGF0ZVNlbGVjdG9yLCB1c2VySWQsIHtvcGVuRGVsZXRlV2luZG93fSwgb3BlbkltYWdlLCBoYW5kbGVMaWtlQ2FyZCkge1xyXG4gICAgICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX2FycmF5TGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX29wZW5JbWFnZSA9IG9wZW5JbWFnZTtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgICAgICB0aGlzLl9vcGVuRGVsZXRlV2luZG93ID0gb3BlbkRlbGV0ZVdpbmRvdztcclxuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcclxuXHJcbiAgICAgICAgdGhpcy5fZWxlbWVudFBob3RvID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fcGhvdG8nKTtcclxuICAgICAgICB0aGlzLl9jb3VudExpa2VzID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZS1udW1iZXInKTtcclxuICAgICAgICB0aGlzLl9idXR0b25UcmFzaCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX3RyYXNoJyk7XHJcbiAgICAgICAgdGhpcy5faWNvbkJ1dHRvbkxpa2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlLWljb24nKTtcclxuICAgIH1cclxuXHJcbiAgICAvL9Cy0L7Qt9Cy0YDQsNGJ0LDQtdGCINGB0LXQu9C10LrRgtC+0YAg0YjQsNCx0LvQvtC90LBcclxuICAgIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXHJcbiAgICAgICAuY29udGVudFxyXG4gICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50JylcclxuICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8v0YPRgdGC0LDQvdC+0LLRidC40Log0YHQvtCx0YvRgtC40LlcclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBjb25zdCBidXR0b25MaWtlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZScpO1xyXG5cclxuICAgICAgICAvL9C70LDQudC6XHJcbiAgICAgICAgYnV0dG9uTGlrZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy/QvtGC0LrRgNGL0YLRjCDQvtC60L3QviDRg9C00LDQu9C10L3QuNGPXHJcbiAgICAgICAgdGhpcy5fYnV0dG9uVHJhc2guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX29wZW5EZWxldGVXaW5kb3codGhpcy5fZWxlbWVudC5fZWxlbWVudCwgdGhpcy5fZGF0YS5faWQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL9C+0YLQutGA0YvRgtGMINGE0L7RgtC+0LPRgNCw0YTQuNGOXHJcbiAgICAgICAgdGhpcy5fZWxlbWVudFBob3RvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9vcGVuSW1hZ2Uoe2xpbms6IHRoaXMuX2RhdGEubGluaywgbmFtZTogdGhpcy5fZGF0YS5uYW1lfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TGlrZXMgKGFycikge1xyXG4gICAgICAgIHRoaXMuX2NvdW50TGlrZXMudGV4dENvbnRlbnQgPSBhcnIubGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUxpa2UoKSB7XHJcbiAgICAgICAgdGhpcy5faWNvbkJ1dHRvbkxpa2UuY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9fbGlrZS1pY29uX2FjdGl2ZScpO1xyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrTGlrZSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5TGlrZXMuc29tZShpdGVtID0+IGl0ZW0uX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZVdpbmRvdygpIHtcclxuICAgICAgICB0aGlzLl9idXR0b25UcmFzaC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fb3BlbkRlbGV0ZVdpbmRvdyh0aGlzLCB0aGlzLl9kYXRhLl9pZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrSWQodXNlcklkKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RhdGEub3duZXIuX2lkICE9PSB1c2VySWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uVHJhc2guY2xhc3NMaXN0LmFkZCgnZWxlbWVudF9fdHJhc2hfYmxvY2tlZCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL9GD0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdGCINC60LDRgNGC0L7Rh9C60LUg0L3QsNC30LLQsNC90LjQtSwg0LrQsNGA0YLQuNC90LrRgyDQuCDQvtC/0LjRgdCw0L3QuNC1XHJcbiAgICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudFBob3RvLnNyYyA9IHRoaXMuX2RhdGEubGluaztcclxuICAgICAgICB0aGlzLl9lbGVtZW50UGhvdG8uYWx0ID0gdGhpcy5fZGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2Rlc2NyaXB0aW9uJykudGV4dENvbnRlbnQgPSB0aGlzLl9kYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5nZXRMaWtlcyh0aGlzLl9hcnJheUxpa2VzKTtcclxuICAgICAgICBpZiAodGhpcy5jaGVja0xpa2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUxpa2UoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXApIHtcclxuICAgICAgICB0aGlzLl9wb3B1cFNlbGVjdG9yID0gcG9wdXA7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXAnKSB8fCAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZS1pY29uJykpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwLCBoYW5kbGVTdWJtaXRGb3JtKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXApO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0gPSBoYW5kbGVTdWJtaXRGb3JtO1xyXG5cclxuICAgICAgICB0aGlzLl9mb3JtID0gcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gcG9wdXAucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8v0YHQvtCx0LjRgNCw0LXRgiDQtNCw0L3QvdGL0LUg0YEg0L/QvtC70LXQuVxyXG4gICAgX2dldElucHV0VmFsdWVzICgpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dFZhbHVlTGlzdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0VmFsdWVMaXN0W2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRWYWx1ZUxpc3Q7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9saXN0ID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLl9saXN0LnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgbGluazogdGhpcy5fbGlzdC5hYm91dH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yIChjb25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2NvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy/RgdC60YDRi9GC0Ywg0L7RiNC40LHQutGDINCy0LLQvtC00LBcclxuICAgIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvL9C/0YDQvtCy0LXRgNC60LAg0YTQvtGA0LzRiyDQvdCwINCy0LDQu9C40LTQvdC+0YHRgtGMXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7IC8v0LXRgdC70Lgg0LXRgdGC0Ywg0L7RiNC40LHQutCwXHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy/Qv9GA0L7QstC10YDQutCwINC60LDQttC00L7Qs9C+INC/0L7Qu9GPINC90LAg0L7RiNC40LHQutGDINCyINC/0L7Qu9C1INCy0LLQvtC00LBcclxuICAgIF9oYXNJbnZhbGlkSW5wdXQgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvL9GB0LTQtdC70LDRgtGMINC60L3QvtC/0LrRgyDQvdC10LDQutGC0LjQstC90L7QuSjQsNC60YLQuNCy0L3QvtC5KSDQv9GA0Lgg0L7RiNC40LHQutC1KNC/0YDQsNCy0LjQu9GM0L3QvtC8INCy0LLQvtC00LUpXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvL9GD0YHRgtCw0L3QvtCy0LjRgtGMINGB0LvRg9GI0LDRgtC10LvQuCDQvdCwINC60LDQttC00YPRjiDRhNC+0YDQvNGDXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgKCkge1xyXG4gICAgICAgIC8v0L/RgNC+0LLQtdGA0LjRgtGMINC60L3QvtC/0LrRgyDQv9GA0Lgg0L7RgtC60YDRi9GC0LjQuCDRhNC+0YDQvNGLXHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgXHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCk9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAvL9C/0YDQvtCy0LXRgNGP0YLRjCDQutC90L7Qv9C60YMg0L/RgNC4INCy0LLQvtC00LUg0LrQsNC20LTQvtCz0L4g0YHQuNC80LLQvtC70LBcclxuICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgLy/Qt9Cw0LHQu9C+0LrQuNGA0L7QstCw0YLRjCDQutC90L7Qv9C60YMg0L/RgNC4INC+0YLQutGA0YvRgtC40Lgg0L/QvtC/0LDQv9CwXHJcbiAgICBibG9ja0J1dHRvblNhdmUocG9wdXApIHtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3BvcHVwX19zYXZlX2luYWN0aXZlJyk7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICAgIFxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IgKHBvcHVwLCBoYW5kbGVTdWJtaXRGb3JtRGVsZXRlKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXApO1xyXG4gICAgICAgIC8vIHRoaXMuX2VsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm1EZWxldGUgPSBoYW5kbGVTdWJtaXRGb3JtRGVsZXRlO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1EZWxldGUgPSBwb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICAgIH1cclxuXHJcbiAgICAvL9GB0LvRg9GI0LDRgtC10LvQuFxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybURlbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXRGb3JtRGVsZXRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBkZWxldGVDYXJkVGVtcGxhdGlvbigpIHtcclxuICAgIC8vICAgICB0aGlzLl9lbGVtZW50Ll9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgLy8gICAgIHRoaXMuX2VsZW1lbnQuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgLy8gICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICAvLyB9XHJcbn0iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcclxuaW1wb3J0IFBvcHVwRGVsZXRlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzXCI7XHJcbiAgXHJcbmNvbnN0IHBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGFnZScpO1xyXG4gIFxyXG5leHBvcnQgY29uc3QgZm9ybUVkaXRQcm9maWxlID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcuZm9ybS1lZGl0Jyk7XHJcbmV4cG9ydCBjb25zdCBmb3JtQWRkQ2FyZCA9IHBhZ2UucXVlcnlTZWxlY3RvcignLmZvcm0tYWRkJyk7XHJcbmV4cG9ydCBjb25zdCBpbWFnZUZ1bGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfaW1hZ2UtZnVsbCcpO1xyXG5jb25zdCB3aW5kb3dEZWxldGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGVsZXRlLXBvcHVwJyk7XHJcbiAgXHJcbmV4cG9ydCBjb25zdCBidXR0b25FZGl0ID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkFkZCA9IHBhZ2UucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fbmFtZScpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gcGFnZS5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQaG90byA9IHBhZ2UucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3Bob3RvJyk7XHJcbiAgXHJcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXQgPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwJyk7XHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXRFZGl0ID0gZm9ybUVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBqb2JJbnB1dEVkaXQgPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uJyk7XHJcbiAgXHJcbmV4cG9ydCBjb25zdCBwb3B1cEFkZCA9IGZvcm1BZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cCcpO1xyXG5leHBvcnQgY29uc3QgbmFtZUlucHV0QWRkID0gZm9ybUFkZENhcmQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX3RpdGxlJyk7XHJcbmV4cG9ydCBjb25zdCBzcmNJbnB1dEFkZCA9IGZvcm1BZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9saW5rJyk7XHJcblxyXG5leHBvcnQgY29uc3QgcG9wdXBEZWxldGUgPSB3aW5kb3dEZWxldGUucXVlcnlTZWxlY3RvcignLnBvcHVwJyk7XHJcbmV4cG9ydCBjb25zdCBidXR0b25EZWxldGUgPSB3aW5kb3dEZWxldGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19zYXZlJyk7XHJcbiAgXHJcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlID0gaW1hZ2VGdWxsLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cCcpO1xyXG4gIFxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmaWVsZHNldFNlbGVjdG9yOiAnLnBvcHVwX19mb3JtLXNldCcsXHJcbiAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19zYXZlJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX3NhdmVfaW5hY3RpdmUnLFxyXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAncG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZSdcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2VPYmplY3QgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoaW1hZ2VGdWxsKTtcclxucG9wdXBJbWFnZU9iamVjdC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy/QvtGC0LrRgNGL0YLRjCDQutCw0YDRgtC40L3QutGDXHJcbmV4cG9ydCBmdW5jdGlvbiBvcGVuSW1hZ2UgKHtsaW5rLCBuYW1lfSkge1xyXG4gIHBvcHVwSW1hZ2VPYmplY3Qub3BlbihuYW1lLCBsaW5rKTtcclxufVxyXG5cclxuLy/RgdC+0LfQtNCw0L3QuNC1INC60LDRgNGC0L7Rh9C60LhcclxuLy8gZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNhcmQoZWxlbWVudCwgdXNlcklkLCBvcGVuRGVsZXRlV2luZG93KSB7XHJcbi8vICAgY29uc3QgZWxlbWVudENhcmQgPSBuZXcgQ2FyZChlbGVtZW50LCAnI2VsZW1lbnQnLCB7b3BlbkRlbGV0ZVdpbmRvd30sIHtvcGVuSW1hZ2V9KTtcclxuLy8gICBlbGVtZW50Q2FyZC5jaGVja0lkKHVzZXJJZCk7XHJcbi8vICAgZWxlbWVudENhcmQuZGVsZXRlQ2FyZCgpO1xyXG4vLyAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGVsZW1lbnRDYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG5cclxuLy8gICByZXR1cm4gY2FyZFRlbXBsYXRlO1xyXG4vLyB9IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwKTtcclxuXHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuICAgICAgICB0aGlzLl9maWdjYXB0aW9uID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ZpZ2NhcHRpb24nKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fZmlnY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0ICcuL2luZGV4LmNzcyc7XHJcblxyXG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24uanMnO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XHJcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnO1xyXG5pbXBvcnQgUG9wdXBEZWxldGUgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cERlbGV0ZS5qcyc7XHJcblxyXG5pbXBvcnQgeyB2YWxpZGF0aW9uQ29uZmlnLCBmb3JtQWRkQ2FyZCwgZm9ybUVkaXRQcm9maWxlLCBwb3B1cEFkZCwgcG9wdXBFZGl0LCBidXR0b25BZGQsIGJ1dHRvbkVkaXQsIG5hbWVJbnB1dEFkZCwgbmFtZUlucHV0RWRpdCwgc3JjSW5wdXRBZGQsIGpvYklucHV0RWRpdCxcclxucHJvZmlsZU5hbWUsIHByb2ZpbGVEZXNjcmlwdGlvbiwgcHJvZmlsZVBob3RvLCBwb3B1cERlbGV0ZSwgb3BlbkltYWdlfSBmcm9tICcuLi91dGlscy91dGlscy5qcyc7XHJcbi8vIGltcG9ydCB7IGNyZWF0ZUNhcmQgfSBmcm9tICcuLi91dGlscy91dGlscy5qcyc7XHJcblxyXG4vLyDQktCw0LvQuNC00LDRhtC40Y9cclxuY29uc3QgZm9ybUFkZFZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtQWRkQ2FyZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKSk7XHJcbmNvbnN0IGZvcm1FZGl0VmFsaWRhdGlvbiA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGZvcm1FZGl0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKSk7XHJcbmZvcm1BZGRWYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuZm9ybUVkaXRWYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gICAgYmFzZVVybDogJ2h0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNjAnLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246ICcxMWMyNjJkOS00MTcyLTQ1OGMtOTI0ZS1kMzAwOWRhNTI2ZDQnLFxyXG4gICAgICAgICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgIH1cclxuICB9KTtcclxuXHJcbmNvbnN0IGluZm9Vc2VyID0gbmV3IFVzZXJJbmZvKHtcclxuICAgIHRpdGxlOiBwcm9maWxlTmFtZSxcclxuICAgIGFib3V0OiBwcm9maWxlRGVzY3JpcHRpb25cclxufSk7XHJcblxyXG5sZXQgdXNlcklkO1xyXG5sZXQgY2FyZEVsZW1lbnQ7XHJcbi8v0L/QvtC70YPRh9C10L3QuNC1INC40L3RhNC+0YDQvNCw0YbQuNC4INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQuCDQutCw0YDRgtC+0YfQtdC6INGBINGB0LXRgNCy0LXRgNCwXHJcblByb21pc2UuYWxsKFthcGkuZ2V0SW5mbygpLCBhcGkuZ2V0Q2FyZCgpXSlcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBjb25zdCB1c2VyRGF0YSA9IHJlc1swXTtcclxuICAgIGNvbnN0IGNhcmRzRGF0YSA9IHJlc1sxXTtcclxuICAgIFxyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgY2FyZEVsZW1lbnQgPSBjYXJkc0RhdGE7XHJcblxyXG4gICAgaW5mb1VzZXIuc2V0VXNlckluZm8oe1xyXG4gICAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0XHJcbiAgICB9KTtcclxuICAgIGluZm9Vc2VyLnNldEF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG5cclxuICAgIGNhcmRSZW5kZXIucmVuZGVySXRlbXMoY2FyZHNEYXRhKTtcclxuICB9KTtcclxuXHJcbi8v0LTQvtCx0LDQstC70LXQvdC40LUg0L3QvtCy0L7QuSDQutCw0YDRgtC+0YfQutC4XHJcbmNvbnN0IHBvcHVwQWRkQ2FyZCA9IG5ldyBQb3B1cFdpdGhGb3JtKHBvcHVwQWRkLCAoe25hbWUsIGxpbmt9KSA9PiB7XHJcbiAgICBhcGkucG9zdENhcmQoe25hbWUsIGxpbmt9KVxyXG4gICAgICAgIC50aGVuICgocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIHJlbmRlckNhcmQocmVzKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgICAgICAgcG9wdXBBZGRDYXJkLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbn0pO1xyXG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8v0YTRg9C90LrRhtC40Y8g0L/QvtGB0YLQsNCy0LjRgtGML9GD0LTQsNC70LjRgtGMINC70LDQudC6XHJcbmZ1bmN0aW9uIHB1dExpa2UgKGNhcmQsIGNhcmRJZCkge1xyXG4gaWYgKGNhcmQuY2hlY2tMaWtlKCkpIHtcclxuICAgIGNvbnNvbGUubG9nKGNhcmQuY2hlY2tMaWtlKCkpO1xyXG4gICAgYXBpLmRlbGV0ZUxpa2UoY2FyZElkKVxyXG4gICAgICAgIC50aGVuICgocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQuZ2V0TGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgICAgY2FyZC50b2dnbGVMaWtlKCk7XHJcbiAgICAgICAgfSk7XHJcbiB9IGVsc2Uge1xyXG4gICAgY29uc29sZS5sb2coY2FyZC5jaGVja0xpa2UoKSk7XHJcbiAgICBhcGkucHV0TGlrZShjYXJkSWQpXHJcbiAgICAgICAgLnRoZW4gKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5nZXRMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgICBjYXJkLnRvZ2dsZUxpa2UoKTtcclxuICAgICAgICB9KTtcclxuIH1cclxufVxyXG5cclxuLy8g0YTRg9C90LrRhtC40Y8g0YDQtdC90LTQtdGA0LAg0LrQsNGA0YLQvtGH0LXQulxyXG5mdW5jdGlvbiByZW5kZXJDYXJkIChlbGVtZW50KSB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoZWxlbWVudCwgJyNlbGVtZW50JywgdXNlcklkLCB7b3BlbkRlbGV0ZVdpbmRvd30sIG9wZW5JbWFnZSwgaGFuZGxlTGlrZUNhcmQpO1xyXG4gICAgY2FyZC5jaGVja0lkKHVzZXJJZCk7XHJcbiAgICBjYXJkLmRlbGV0ZVdpbmRvdygpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUxpa2VDYXJkICgpIHtcclxuICAgICAgICBwdXRMaWtlKGNhcmQsIGVsZW1lbnQuX2lkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDRg9C00LDQu9C10L3QuNC1INC60LDRgNGC0L7Rh9C60Lgg0YEg0YHQtdGA0LLQtdGA0LBcclxuICAgIGNvbnN0IG9wZW5EZWxldGVQb3B1cCA9IG5ldyBQb3B1cERlbGV0ZShwb3B1cERlbGV0ZSwgKCkgPT4ge1xyXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGVsZW1lbnQuX2lkKVxyXG4gICAgICAgICAgICAudGhlbiAoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICAgICAgICAgICAgICBvcGVuRGVsZXRlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDRhC3RhtC40Y8g0L7RgtC60YDRi9GC0LjRjyDQv9C+0L/QsNC/0LAg0Lgg0L3QsNCy0LXRiNC40LLQsNC90LjQtSDRgdC70YPRiNCw0YLQtdC70LXQuVxyXG4gICAgZnVuY3Rpb24gb3BlbkRlbGV0ZVdpbmRvdygpIHtcclxuICAgICAgICBvcGVuRGVsZXRlUG9wdXAub3BlbigpO1xyXG4gICAgICAgIG9wZW5EZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICAgIGNhcmRSZW5kZXIuYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbn1cclxuXHJcbi8vINGA0LXQvdC00LXRgCDQutCw0YDRgtC+0YfQtdC6XHJcbmNvbnN0IGNhcmRSZW5kZXIgPSBuZXcgU2VjdGlvbiggcmVuZGVyQ2FyZCwgJy5lbGVtZW50cycpO1xyXG5cclxuLy8g0LjQt9C80LXQvdC40YLRjCDQuNC80Y8g0Lgg0L7Qv9C40YHQsNC90LjQtSDQv9GA0L7RhNC40LvRj1xyXG5jb25zdCBwb3B1cEVkaXRQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBFZGl0LCAoe25hbWUsIGxpbmt9KSA9PiB7XHJcbiAgICBhcGkucGF0Y2hJbmZvKHtuYW1lLCBsaW5rfSlcclxuICAgICAgICAudGhlbiAoKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICBpbmZvVXNlci5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiByZXMubmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0OiByZXMuYWJvdXRcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHBvcHVwRWRpdFByb2ZpbGUuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxufSk7XHJcblxyXG5wb3B1cEVkaXRQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL9GB0LvRg9GI0LDRgtC10LvRjCDQutC90L7Qv9C60Lgg0LTQvtCx0LDQstC40YLRjFxyXG5idXR0b25BZGQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBwb3B1cEFkZENhcmQub3BlbigpO1xyXG4gICAgbmFtZUlucHV0QWRkLnZhbHVlID0gJyc7XHJcbiAgICBzcmNJbnB1dEFkZC52YWx1ZSA9ICcnO1xyXG4gICAgZm9ybUFkZFZhbGlkYXRpb24uYmxvY2tCdXR0b25TYXZlKHBvcHVwQWRkKTtcclxufSk7XHJcblxyXG4vL9GB0LvRg9GI0LDRgtC10LvRjCDQutC90L7Qv9C60Lgg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRj1xyXG5idXR0b25FZGl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgY29uc3QgaW5mb0Zyb21QYWdlID0gaW5mb1VzZXIuZ2V0VXNlckluZm8oKTtcclxuICAgIG5hbWVJbnB1dEVkaXQudmFsdWUgPSBpbmZvRnJvbVBhZ2UubmFtZTtcclxuICAgIGpvYklucHV0RWRpdC52YWx1ZSA9IGluZm9Gcm9tUGFnZS5hYm91dDtcclxuICAgIHBvcHVwRWRpdFByb2ZpbGUub3BlbigpO1xyXG59KTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5fdXJsID0gY29uZmlnLmJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ9Cf0YDQvtC40LfQvtGI0LvQsCDQvtGI0LjQsdC60LAnKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5mbygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuICh0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q2FyZCgpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuICh0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcGF0Y2hJbmZvKGRhdGEpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBhYm91dDogZGF0YS5saW5rXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4gKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBwb3N0Q2FyZChkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiBkYXRhLmxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbiAodGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7ZGF0YX1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtkYXRhfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbiAodGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1dExpa2UoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7ZGF0YX0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtkYXRhfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbiAodGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUxpa2UoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7ZGF0YX0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtkYXRhfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbiAodGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX3RpdGxlID0gZGF0YS50aXRsZTtcclxuICAgICAgICB0aGlzLl9hYm91dCA9IGRhdGEuYWJvdXQ7XHJcblxyXG4gICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX25hbWUnKTtcclxuICAgICAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKTtcclxuICAgICAgICB0aGlzLl9wcm9maWxlUGhvdG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fcGhvdG8nKTtcclxuICAgIH1cclxuXHJcbiAgICAvL9GB0L7QsdC40YDQsNC10YIg0LTQsNC90L3Ri9C1INGB0L4g0YHRgtGA0LDQvdC40YbRi1xyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgY29uc3QgZm9ybVRpdGxlID0gdGhpcy5fdGl0bGUudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgY29uc3QgZm9ybURlc2NyaXB0aW9uID0gdGhpcy5fYWJvdXQudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgcmV0dXJuIHtuYW1lOiBmb3JtVGl0bGUsIGFib3V0OiBmb3JtRGVzY3JpcHRpb259O1xyXG4gICAgfVxyXG5cclxuICAgIC8v0YPRgdGC0LDQvdCw0LLQu9C40LLQsNC10YIg0L3QvtCy0L7QtSDQuNC80Y8g0Lgg0L7Qv9C40YHQsNC90LjQtVxyXG4gICAgc2V0VXNlckluZm8oe25hbWUsIGFib3V0fSkge1xyXG4gICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgIH1cclxuXHJcbiAgICBzZXRBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZVBob3RvLnNyYyA9IGF2YXRhcjtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIgLCBzZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtIChlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0b3IucHJlcGVuZChlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgICAgIGl0ZW1zLnJldmVyc2UoKS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInRlbXBsYXRlU2VsZWN0b3IiLCJ1c2VySWQiLCJvcGVuRGVsZXRlV2luZG93Iiwib3BlbkltYWdlIiwiaGFuZGxlTGlrZUNhcmQiLCJ0aGlzIiwiX2RhdGEiLCJfYXJyYXlMaWtlcyIsImxpa2VzIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfb3BlbkltYWdlIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJfb3BlbkRlbGV0ZVdpbmRvdyIsIl91c2VySWQiLCJfaGFuZGxlTGlrZUNhcmQiLCJfZWxlbWVudFBob3RvIiwicXVlcnlTZWxlY3RvciIsIl9jb3VudExpa2VzIiwiX2J1dHRvblRyYXNoIiwiX2ljb25CdXR0b25MaWtlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9pZCIsImxpbmsiLCJuYW1lIiwiZ2V0TGlrZXMiLCJhcnIiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsInRvZ2dsZUxpa2UiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJjaGVja0xpa2UiLCJzb21lIiwiaXRlbSIsImRlbGV0ZVdpbmRvdyIsImRlbGV0ZUNhcmQiLCJyZW1vdmUiLCJjaGVja0lkIiwib3duZXIiLCJhZGQiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJQb3B1cCIsInBvcHVwIiwiX3BvcHVwU2VsZWN0b3IiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwib3BlbiIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0Rm9ybSIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdEZvcm0iLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0VmFsdWVMaXN0IiwiZm9yRWFjaCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJfbGlzdCIsInRpdGxlIiwiYWJvdXQiLCJyZXNldCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9mb3JtRWxlbWVudCIsIl9jb25maWciLCJBcnJheSIsImZyb20iLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiY29uc29sZSIsImxvZyIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsImJsb2NrQnV0dG9uU2F2ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJQb3B1cERlbGV0ZSIsImhhbmRsZVN1Ym1pdEZvcm1EZWxldGUiLCJfaGFuZGxlU3VibWl0Rm9ybURlbGV0ZSIsIl9mb3JtRGVsZXRlIiwicGFnZSIsImZvcm1FZGl0UHJvZmlsZSIsImZvcm1BZGRDYXJkIiwiaW1hZ2VGdWxsIiwid2luZG93RGVsZXRlIiwiYnV0dG9uRWRpdCIsImJ1dHRvbkFkZCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicG9wdXBFZGl0IiwibmFtZUlucHV0RWRpdCIsImpvYklucHV0RWRpdCIsInBvcHVwQWRkIiwibmFtZUlucHV0QWRkIiwic3JjSW5wdXRBZGQiLCJwb3B1cERlbGV0ZSIsInZhbGlkYXRpb25Db25maWciLCJmaWVsZHNldFNlbGVjdG9yIiwicG9wdXBJbWFnZU9iamVjdCIsIl9pbWFnZSIsIl9maWdjYXB0aW9uIiwiZm9ybUFkZFZhbGlkYXRpb24iLCJmb3JtRWRpdFZhbGlkYXRpb24iLCJhcGkiLCJfdXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9oYW5kbGVSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJFcnJvciIsImdldEluZm8iLCJmZXRjaCIsInRoZW4iLCJnZXRDYXJkIiwicGF0Y2hJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwb3N0Q2FyZCIsInB1dExpa2UiLCJkZWxldGVMaWtlIiwiYXV0aG9yaXphdGlvbiIsImluZm9Vc2VyIiwiX3RpdGxlIiwiX2Fib3V0IiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVEZXNjcmlwdGlvbiIsIl9wcm9maWxlUGhvdG8iLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwiYXZhdGFyIiwiY2FyZEVsZW1lbnQiLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzRGF0YSIsImNhcmRSZW5kZXIiLCJyZW5kZXJJdGVtcyIsInBvcHVwQWRkQ2FyZCIsInJlbmRlckNhcmQiLCJlbGVtZW50IiwiY2FyZCIsIm9wZW5EZWxldGVQb3B1cCIsImNhcmRJZCIsImFkZEl0ZW0iLCJyZW5kZXJlciIsInNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX3NlbGVjdG9yIiwicHJlcGVuZCIsIml0ZW1zIiwicmV2ZXJzZSIsInBvcHVwRWRpdFByb2ZpbGUiLCJpbmZvRnJvbVBhZ2UiXSwic291cmNlUm9vdCI6IiJ9